# Phase 06.3: Site Layout

## Overview
Implement the main application shell with responsive navigation, toolbar, and content area using Angular Material components and the established theme system.

## Objectives
- Create responsive application layout
- Implement navigation drawer
- Configure toolbar with actions
- Set up content area with routing
- Ensure mobile responsiveness

## Prerequisites
- Phase 06.1 (Project Setup) completed
- Phase 06.2 (Theme System) completed
- Angular Material components available

## Layout Architecture

### 1. Application Shell Structure

The application uses a classic Material Design layout pattern:
- Fixed toolbar at top
- Collapsible side navigation
- Scrollable content area
- Responsive breakpoints for mobile

#### Component Hierarchy
```
AppComponent (Root)
├── MatToolbar (Header)
│   ├── Menu Toggle Button
│   ├── Application Title
│   └── Toolbar Actions
├── MatSidenav (Navigation)
│   └── Navigation Menu Component
└── MatSidenavContent (Main)
    └── RouterOutlet (Dynamic Content)
```

### 2. App Component Configuration

#### Component Setup
Configure the root AppComponent as a standalone component with:
- Material module imports (toolbar, sidenav, button, icon, menu)
- Router outlet for content
- Service injections for theme and navigation
- Responsive behavior handling

#### Required Imports
- `MatToolbarModule` - Header toolbar
- `MatSidenavModule` - Side navigation
- `MatButtonModule` - Interactive buttons
- `MatIconModule` - Material icons
- `MatMenuModule` - Dropdown menus
- `MatListModule` - Navigation lists
- `CommonModule` - Angular directives
- `RouterOutlet` - Routing support

### 3. Toolbar Implementation

#### Structure
Create a Material toolbar with:
- Fixed positioning at viewport top
- Primary theme color
- Elevation shadow using `--shadow-sm`
- Z-index for proper layering (1000+)

#### Toolbar Elements

**Left Section:**
- Menu toggle button (hamburger icon)
- Application logo/title
- Breadcrumb navigation (optional)

**Center Section (Optional):**
- Search bar
- Context-specific controls

**Right Section:**
- Notification bell with badge
- Theme toggle button
- User avatar with dropdown menu
- Settings gear icon

#### Styling Requirements
- Height: 64px (desktop), 56px (mobile)
- Padding: Use `--spacing-md` horizontally
- Title font: Material headline-6
- Use flexbox with spacer for alignment
- Sticky positioning for scroll

### 4. Side Navigation

#### Sidenav Configuration

**Desktop Behavior:**
- Mode: 'side' (persistent)
- Width: 250px (expanded), 64px (collapsed)
- Always visible on screens > 1024px
- Smooth transition for collapse/expand

**Tablet Behavior:**
- Mode: 'over' (overlay)
- Width: 250px
- Opens on menu button click
- Backdrop when open

**Mobile Behavior:**
- Mode: 'over' (overlay)
- Width: 80% of screen or max 280px
- Swipe gesture support
- Auto-close on navigation

#### Navigation Content
- User profile section (optional)
- Primary navigation menu
- Secondary/utility links
- Footer with version info

#### Styling Requirements
- Background: Material surface color
- Padding: Use `--spacing-md`
- Smooth width transition (300ms)
- Elevation when in overlay mode

### 5. Content Area

#### Layout Configuration
- Full height minus toolbar
- Scrollable overflow
- Background: Material background color
- Responsive padding

#### Content Container
- Padding: `--spacing-lg` (desktop), `--spacing-md` (mobile)
- Max width: `--container-xl` with auto margins
- Min height: calc(100vh - 64px)
- Smooth transitions for sidenav adjustments

#### Router Outlet
- Lazy-loaded feature modules
- Transition animations between routes
- Scroll position restoration
- Loading state handling

### 6. Responsive Breakpoints

Define breakpoint behaviors:

#### Mobile (< 768px)
- Sidenav: Overlay mode
- Toolbar: Reduced height (56px)
- Content padding: `--spacing-md`
- Single column layouts
- Touch-optimized controls

#### Tablet (768px - 1023px)
- Sidenav: Overlay mode
- Toolbar: Full height
- Content padding: `--spacing-lg`
- Two column layouts where appropriate
- Larger touch targets

#### Desktop (≥ 1024px)
- Sidenav: Side mode (persistent)
- Toolbar: Full features visible
- Content padding: `--spacing-lg`
- Multi-column layouts
- Hover states enabled

### 7. Navigation Menu Component

Create a separate NavigationMenuComponent for the sidenav content:

#### Features
- Expandable menu sections
- Active route highlighting
- Icon support for menu items
- Badge support for counts
- Nested menu support

#### Menu Structure
```
Dashboard
Projects
├── All Projects
├── Create New
└── Templates
Agents
├── Running Agents
├── Agent Types
└── Logs
Settings
├── Profile
├── Preferences
└── API Keys
```

#### Styling
- Use Material list components
- Active item: Primary color background
- Hover state: Subtle background change
- Icons: 24px with `--spacing-sm` margin
- Text: Material body-1 typography

### 8. Theme Integration

#### Dark Mode Support
- Toggle stored in service
- Class applied to root element
- Smooth color transitions
- Icon changes (sun/moon)
- System preference detection

#### Theme Application
- All colors from theme variables
- No hardcoded color values
- Proper contrast in both themes
- Accessible focus indicators

### 9. Loading States

#### Initial Load
- Splash screen with logo
- Progress indicator
- Fade transition to app
- Skeleton screens for content

#### Route Transitions
- Progress bar in toolbar
- Fade/slide animations
- Loading placeholders
- Error state handling

### 10. Accessibility Features

#### Navigation
- Skip to content link
- Keyboard navigation support
- ARIA labels for icons
- Focus trap in overlay sidenav

#### Screen Reader Support
- Landmark regions
- Heading hierarchy
- Live regions for updates
- Descriptive button labels

## Implementation Guidelines

### State Management
- Sidenav state in service
- Responsive state with BreakpointObserver
- Theme preference persistence
- Navigation history tracking

### Performance Optimization
- Lazy load feature modules
- OnPush change detection
- Debounced resize handlers
- CSS containment for complex areas

### Testing Requirements

#### Unit Tests
- Component initialization
- Responsive behavior
- Theme switching
- Navigation interactions
- Menu state management

#### E2E Tests
- Navigation flows
- Responsive breakpoints
- Theme persistence
- Keyboard navigation

## Deliverables
- [ ] App shell component implemented
- [ ] Toolbar with all elements
- [ ] Responsive sidenav
- [ ] Navigation menu component
- [ ] Content area with routing
- [ ] Theme toggle functional
- [ ] Mobile responsive design
- [ ] Accessibility features
- [ ] Loading states
- [ ] All theme variables applied

## Next Steps
- Create shared components (Phase 06.4)
- Implement feature modules
- Add authentication flow