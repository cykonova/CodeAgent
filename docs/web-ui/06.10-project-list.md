# Phase 06.8: Project List Page

## Overview
Implement the project list page that displays all projects with filtering, sorting, and management actions.

**Note**: This implementation aligns with the backend `CodeAgent.Projects` service layer. The API endpoints follow standard REST patterns:
- GET `/api/projects` - Get all projects
- GET `/api/projects/{id}` - Get single project
- POST `/api/projects` - Create project
- PUT `/api/projects/{id}` - Update project
- DELETE `/api/projects/{id}` - Delete project
- POST `/api/projects/{id}/clone` - Clone project
- POST `/api/projects/{id}/template` - Apply template
- GET `/api/projects/{id}/state` - Get project state
- PUT `/api/projects/{id}/state` - Update project state

## Objectives
- Display projects in a table format
- Implement search and filtering
- Add project status indicators
- Enable quick actions (activate, pause, delete)
- Show project statistics

## Prerequisites
- Phase 06.1 (Project Setup) completed
- Phase 06.2 (Theme System) completed
- Phase 06.4 (Card Component) completed
- Phase 06.5 (Table Card Component) completed
- Phase 06.7 (WebSocket Service) completed

## Implementation

### 1. Generate Components
Use Angular CLI to generate:
- Standalone project-list component in features/projects
- Project service with test files in features/projects/services

### 2. Project Model Requirements

Create TypeScript interfaces matching the backend C# models:

#### Project Interface
Define the main project structure matching backend:
- `id`: Guid (string) - Unique project identifier
- `name`: string - Project display name
- `description`: string | null - Optional project description
- `type`: ProjectType enum - Project type classification
- `templateName`: string | null - Applied template name
- `createdAt`: Date - Creation timestamp
- `updatedAt`: Date - Last modification timestamp
- `configuration`: ProjectConfiguration - Project settings
- `state`: ProjectState - Runtime state information
- `metadata`: Record<string, any> - Additional metadata

#### ProjectType Enum
Define project types matching backend:
- Standard = 0
- Fast = 1
- Quality = 2
- Budget = 3
- Custom = 4

#### ProjectStatus Enum (from ProjectState)
Define status values matching backend:
- Idle = 0
- Running = 1
- Paused = 2
- Completed = 3
- Failed = 4
- Cancelled = 5

#### ProjectConfiguration Interface
Define configuration matching backend structure:
- `providerId`: string | null - Selected provider
- `workflow`: WorkflowConfiguration - Workflow settings
- `agents`: AgentConfiguration - Agent settings
- `costLimits`: CostConfiguration - Cost management
- `sandbox`: SandboxConfiguration - Sandbox settings
- `customSettings`: Record<string, any> - Custom options

#### ProjectState Interface
Define state tracking:
- `status`: ProjectStatus - Current status
- `currentStage`: string | null - Active stage name
- `lastRunAt`: Date | null - Last execution time
- `lastRunDuration`: number | null - Duration in milliseconds
- `runHistory`: ProjectRun[] - Execution history
- `costSummary`: CostSummary - Cost aggregation
- `runtimeData`: Record<string, any> - Runtime data

#### SecurityLevel Enum (for SandboxConfiguration)
- None = 0
- Container = 1
- VM = 2

#### ProjectStats Interface
Define statistics structure:
- `total`: Total project count
- `active`: Active project count
- `paused`: Paused project count
- `totalAgents`: Total agent count across projects
- `resourceUsage`: Resource utilization percentage

### 3. Project Service Requirements

Create a service for project data management:

#### Service Configuration
- Injectable at root level
- Use HttpClient for API communication
- Implement state management with BehaviorSubject
- Expose observables for reactive data

#### Core Methods
Implement the following service methods matching backend IProjectService:
- `createProject(name: string, configuration?: ProjectConfiguration)`: Create new project
- `getProject(projectId: string)`: Get single project by ID
- `getAllProjects()`: Get all projects
- `updateProject(projectId: string, configuration: ProjectConfiguration)`: Update project configuration
- `deleteProject(projectId: string)`: Delete project
- `cloneProject(sourceProjectId: string, newName: string)`: Clone existing project
- `applyTemplate(projectId: string, templateName: string)`: Apply template to project
- `getProjectState(projectId: string)`: Get project runtime state
- `updateProjectState(projectId: string, state: ProjectState)`: Update project state

#### Additional Frontend Methods
- `getProjectStats()`: Calculate statistics from projects list
- `activateProject(projectId: string)`: Helper to set status to Running
- `pauseProject(projectId: string)`: Helper to set status to Paused
- `stopProject(projectId: string)`: Helper to set status to Idle

#### State Management
- Maintain projects in BehaviorSubject
- Expose projects$ observable for components
- Update state after API operations
- Handle loading and error states

### 4. Project List Component Requirements

#### Component Architecture
Create a standalone component with:
- Import necessary Angular Material modules
- Use Card and TableCard components
- Inject ProjectService for data operations
- Inject Router for navigation
- Use MatSnackBar for notifications
- Use MatDialog for confirmations

#### Template Structure
Build the project list interface with:

**Page Header:**
- Material toolbar for page header
- Page title "Projects"
- Search field with Material form field (outline appearance)
- "New Project" button with primary color and add icon
- Use flexbox spacer for alignment

**Filter Section:**
- Status filter dropdown with options:
  - All Projects
  - Idle
  - Running
  - Paused
  - Completed
  - Failed
  - Cancelled
- Type filter dropdown with options:
  - All Types
  - Standard
  - Fast
  - Quality
  - Budget
  - Custom
- Sort by dropdown with options:
  - Last Modified
  - Name
  - Created Date
  - Status

**Project Table:**
- Use TableCard component
- Pass filtered projects as data
- Configure columns for:
  - Project Name (sortable, from `name` field)
  - Type (badge, from `type` enum)
  - Status (with badge styling, from `state.status`)
  - Current Stage (from `state.currentStage`)
  - Last Run (date format, from `state.lastRunAt`)
  - Updated (date format, from `updatedAt`)
  - Created (date format, from `createdAt`)
- Configure row actions:
  - Run/Resume (play icon, primary color, for Idle/Paused)
  - Pause (pause icon, accent color, for Running)
  - Clone (copy icon)
  - Configure (settings icon)
  - Delete (delete icon, warn color)
- Enable striped rows and hover effects
- Handle row click for navigation

**Statistics Grid:**
- Display project statistics in card grid
- Show cards for:
  - Total Projects
  - Active Projects
  - Total Agents
  - Resource Usage
- Use small padding variant for stat cards
- Apply appropriate styling for values

#### Component Logic Implementation

**Properties:**
- `projects`: Array of all projects
- `filteredProjects`: Array of filtered/sorted projects
- `stats`: Project statistics object
- `searchTerm`: Search input value
- `statusFilter`: Selected status filter
- `sortBy`: Selected sort field
- `tableConfig`: Table configuration object

**Methods:**
- `ngOnInit()`: Load projects and statistics on initialization
- `loadProjects()`: Fetch all projects from service
- `calculateStats()`: Calculate statistics from projects list
- `onSearch()`: Handle search input changes
- `applyFilters()`: Apply status, type, and search filters
- `applySort()`: Sort filtered projects
- `getSubtitle()`: Generate dynamic subtitle for table
- `getStatCards()`: Transform stats into card display format
- `viewProject(projectId: string)`: Navigate to project details
- `createProject()`: Open create project dialog
- `runProject(projectId: string)`: Start or resume project execution
- `pauseProject(projectId: string)`: Pause running project
- `cloneProject(projectId: string)`: Create copy of project
- `configureProject(projectId: string)`: Open project configuration
- `deleteProject(projectId: string)`: Delete project with confirmation
- `applyTemplate(projectId: string)`: Open template selection dialog

**Filter Logic:**
- Implement case-insensitive search across name and description
- Filter by selected status or show all
- Maintain filter state during operations

**Sort Logic:**
- Sort by name alphabetically
- Sort by dates (newest first)
- Sort by status alphabetically
- Maintain sort after filter changes

### 5. Component Styling Guidelines

#### Container Layout
- Use full width container
- Apply consistent spacing using theme variables

#### Page Header
- Transparent background
- Bottom padding: Use `--spacing-md` variable
- Title font size: 1.8rem with Material typography
- Search field width: 300px
- Field margin: Use `--spacing-md` variable

#### Filter Section
- Flexbox layout with gap using `--spacing-md`
- Bottom margin: Use `--spacing-lg` variable
- Form field width: 200px each
- Use Material form field outline appearance

#### Statistics Grid
- CSS Grid with auto-fit columns
- Minimum column width: 200px
- Gap: Use `--spacing-md` variable
- Top margin: Use `--spacing-lg` variable

#### Stat Card Styling
- Value font size: 1.5rem
- Font weight: Use `--font-weight-medium` variable
- Center aligned text
- Padding: Use `--spacing-md` variable
- Success color: Material green for active count

#### Responsive Design
- Adjust search field width on mobile
- Stack filters vertically on small screens
- Responsive grid columns for statistics
- Ensure table scrolls horizontally on mobile

### 6. Route Configuration

Configure routing for the project list:
- Path: `/projects`
- Lazy load the component
- Set as default projects route
- Configure child routes for create/edit/details

## Testing

### Unit Test Requirements

Create comprehensive tests covering:
- Component initialization
- Project loading and display
- Filter functionality
- Sort functionality
- Search functionality
- Action method calls
- Navigation triggers
- Statistics calculation

**Mock Setup:**
- Mock ProjectService methods
- Mock Router navigation
- Mock MatSnackBar notifications
- Mock MatDialog confirmations

**Test Cases:**
- Projects load on initialization
- Filters apply correctly
- Search filters projects
- Sort orders projects correctly
- Actions call appropriate service methods
- Navigation works for view/edit
- Statistics display correctly
- Empty state shows when no projects

### Manual Testing Checklist
- [ ] Page loads with project data
- [ ] Search filters projects in real-time
- [ ] Status filter shows correct subset
- [ ] Sort changes order correctly
- [ ] Table displays all columns properly
- [ ] Status badges show correct colors
- [ ] Action buttons trigger correctly
- [ ] Row click navigates to details
- [ ] Statistics update with data changes
- [ ] Responsive layout works on mobile
- [ ] Theme variables applied throughout
- [ ] No hardcoded colors or spacing

## Deliverables
- [ ] Project list page displays all projects
- [ ] Search functionality works
- [ ] Status filtering functional
- [ ] Sorting implemented
- [ ] Quick actions work (activate, pause, delete)
- [ ] Statistics cards display
- [ ] Navigation to project details works
- [ ] All styling uses theme variables
- [ ] Unit tests passing
- [ ] Responsive design complete

## Next Steps
- Implement Project Create Page (06.11)
- Implement Project Details Page (06.12)