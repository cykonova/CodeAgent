<div class="chat-header">
  <div class="header-left">
    <h2>{{ title }}</h2>
    @if (subtitle) {
      <span class="subtitle">{{ subtitle }}</span>
    }
    <div class="session-info">
      @if (showPermissionsBadge && permissionsCount > 0) {
        <mat-chip class="permissions-chip">
          <mat-icon>security</mat-icon>
          {{ permissionsCount }} permissions active
        </mat-chip>
      }
    </div>
  </div>
  
  <div class="header-center">
    <div class="provider-selection">
      <mat-form-field appearance="outline" class="provider-field">
        <mat-label>Provider</mat-label>
        <mat-select [value]="selectedProvider" (selectionChange)="onProviderChange($event)">
          @for (provider of availableProviders; track provider.id) {
            <mat-option [value]="provider.id">
              <div class="provider-option">
                <mat-icon>{{ getProviderIcon(provider.type) }}</mat-icon>
                <span>{{ provider.name }}</span>
                @if (!provider.enabled) {
                  <mat-icon class="disabled-icon">cancel</mat-icon>
                }
              </div>
            </mat-option>
          }
        </mat-select>
      </mat-form-field>
      
      <mat-form-field appearance="outline" class="model-field">
        <mat-label>Model</mat-label>
        <mat-select [value]="selectedModel" (selectionChange)="onModelChange($event)" [disabled]="!selectedProvider">
          @for (model of availableModels; track model) {
            <mat-option [value]="model">{{ model }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>
  </div>
  <div class="header-actions">
    @for (action of actions; track action.id) {
      <button mat-icon-button 
              (click)="onActionClick(action.id)"
              [class.active]="action.active"
              [matBadge]="action.badge"
              [matBadgeHidden]="!action.badge || action.badge === 0"
              matBadgeColor="accent"
              matBadgeSize="small"
              [matTooltip]="action.tooltip">
        <mat-icon>{{ action.icon }}</mat-icon>
      </button>
    }
    @if (actions.length > 0) {
      <mat-divider [vertical]="true"></mat-divider>
    }
    <button mat-icon-button 
            (click)="onClearSession()" 
            matTooltip="Clear Session">
      <mat-icon>clear_all</mat-icon>
    </button>
  </div>
</div>